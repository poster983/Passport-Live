#!/usr/bin/env node
/*
  Passport-Live is a modern web app for schools that helps them manage passes.
    Copyright (C) 2017  Joseph Hassell

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published
    by the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

email: hi@josephhassell.com
*/
var r = require('rethinkdb');
  var connection = null;
var p = r.connect( {host: 'localhost', port: 28015}, function(err, conn) {
    if (err) throw err;
    connection = conn;
});
p.then(function(conn) {
   r.dbCreate('passport').run(conn, function() {
    //create accounts
   	r.db('passport').tableCreate('accounts').run(conn, function(res) {
      console.log(res); 
    });
    //create 
    r.db('passport').tableCreate('permissionKeys').run(conn, function(res) {
      console.log(res); 
    });
     r.db('passport').tableCreate('scheduleDefinitions').run(conn, function(res) {
      console.log(res); 
    });
    r.db('passport').tableCreate('scheduleCalendar').run(conn, function(res) {
      console.log(res); 
    });
    r.db('passport').tableCreate('userSchedules').run(conn, function(res) {
      console.log(res); 
      /*
      r.db('passport').table("userSchedules").indexCreate("userId").run(conn, function(res) {
        console.log("SECONDARY")
        console.log(res); 
      });*/
    });
    r.db('passport').tableCreate('scheduleRepeating').run(conn, function(res) {
      console.log(res); 
    });
    r.db('passport').tableCreate('apiKeys').run(conn, function(res) {
      console.log(res); 
    });
     r.db('passport').tableCreate('blackouts').run(conn, function(res) {
      console.log(res); 
      process.exit();
    });



//secondary index
   
})
}).error(function(error) {
    console.err(error);
});
