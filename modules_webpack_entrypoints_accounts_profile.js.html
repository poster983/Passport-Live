<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>modules/webpack/entrypoints/accounts/profile.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="nav">
    <h2><a href="index.html">Home</a></h2><h3>Tutorials</h3><ul><li><a href="tutorial-Configs.html">Configs</a></li><li><a href="tutorial-Setup Error Monitoring.html">Setup Error Monitoring</a></li><li><a href="tutorial-Usergroup Database Models.html">Usergroup Database Models</a></li><li><a href="tutorial-Web App System Requirements.html">Web App System Requirements</a></li></ul><h3>API</h3><ul><li><a href="#">/api/account/</a><ul class='methods'><li data-type='method'><a href="global.html#searchAccounts">GET</a></li></ul></li><li><a href="#">/api/account/email/:email/</a><ul class='methods'><li data-type='method'><a href="global.html#getAccountsByEmail">GET</a></li></ul></li><li><a href="#">/api/account/groupfields/</a><ul class='methods'><li data-type='method'><a href="global.html#handleUpdateAccountGroupFieldsByUser">PATCH</a></li></ul></li><li><a href="#">/api/account/hasClasses</a><ul class='methods'><li data-type='method'><a href="global.html#getAccountsWithClasses">GET</a></li></ul></li><li><a href="#">/api/account/id/:id</a><ul class='methods'><li data-type='method'><a href="global.html#handleGetAccountsById">GET</a></li></ul></li><li><a href="#">/api/account/incomplete/dashboard/student</a><ul class='methods'><li data-type='method'><a href="global.html#studentCheckIfIncomplete">GET</a></li></ul></li><li><a href="#">/api/account/location/datetime/:dateTime/id/:id/</a><ul class='methods'><li data-type='method'><a href="global.html#getCurrentLocation">GET</a></li></ul></li><li><a href="#">/api/account/name/:name/</a><ul class='methods'><li data-type='method'><a href="global.html#handleGetAccountsByName">GET</a></li></ul></li><li><a href="#">/api/account/new/:userGroup/</a><ul class='methods'><li data-type='method'><a href="global.html#handleNewAccount">POST</a></li></ul></li><li><a href="#">/api/account/password/</a><ul class='methods'><li data-type='method'><a href="global.html#updateUserPassword">PATCH</a></li></ul></li><li><a href="#">/api/account/schedule/:dashboard</a><ul class='methods'><li data-type='method'><a href="module-api_userSchedule.html#~setUserSchedule">POST</a></li><li data-type='method'><a href="module-api_userSchedule.html#~updateUserSchedule">PUT</a></li><li data-type='method'><a href="module-api_userSchedule.html#~updateUserSchedule">PATCH</a></li></ul></li><li><a href="#">/api/account/schedule/[:id]</a><ul class='methods'><li data-type='method'><a href="module-api_userSchedule.html#~getAllSchedules">GET</a></li></ul></li><li><a href="#">/api/account/schedule/student/:id</a><ul class='methods'><li data-type='method'><a href="module-api_userSchedule.html#~getSchedulesForStudentDash">GET</a></li></ul></li><li><a href="#">/api/account/schedule/teacher/:id</a><ul class='methods'><li data-type='method'><a href="module-api_userSchedule.html#~getSchedulesForTeacherDash">GET</a></li></ul></li><li><a href="#">/api/account/userGroup/:userGroup/</a><ul class='methods'><li data-type='method'><a href="global.html#handleGetAccountsByUserGroup">GET</a></li></ul></li><li><a href="#">/api/account/userGroup/:userGroup/name/:name/</a><ul class='methods'><li data-type='method'><a href="global.html#handleGetAccountsByNameAndUserGroup">GET</a></li></ul></li><li><a href="#">/api/auth/login/</a><ul class='methods'><li data-type='method'><a href="module-authRESTAPI.html#~handleAuthLogin">POST</a></li></ul></li><li><a href="#">/api/auth/login/dscm</a><ul class='methods'><li data-type='method'><a href="module-authRESTAPI.html#~loginDSCM">POST</a></li></ul></li><li><a href="#">/api/blackout/</a><ul class='methods'><li data-type='method'><a href="module-blackoutRESTAPI.html#~newBlackout">POST</a></li></ul></li><li><a href="#">/api/blackout/date/:date</a><ul class='methods'><li data-type='method'><a href="module-blackoutRESTAPI.html#~getBlackoutByDate">POST</a></li></ul></li><li><a href="#">/api/blackout/user/:userId</a><ul class='methods'><li data-type='method'><a href="module-blackoutRESTAPI.html#~getBlackoutByUserId">POST</a></li></ul></li><li><a href="#">/api/blackout/user/:userId/date/:date</a><ul class='methods'><li data-type='method'><a href="module-blackoutRESTAPI.html#~getBlackoutByUserIdAndDate">POST</a></li></ul></li><li><a href="#">/api/media/avatar/:id/:size.svg</a><ul class='methods'><li data-type='method'><a href="module-mediaRESTAPI.html#~getIdenticon">GET</a></li></ul></li><li><a href="#">/api/media/background/:id.svg</a><ul class='methods'><li data-type='method'><a href="module-mediaRESTAPI.html#~generateBackdrop">GET</a></li></ul></li><li><a href="#">/api/passes/me/</a><ul class='methods'><li data-type='method'><a href="module-passRESTApi.html#~newPassForMe">POST</a></li></ul></li><li><a href="#">/api/passes/me/by/:idCol/from/:fromDay/</a><ul class='methods'><li data-type='method'><a href="module-passRESTApi.html#~getPassForMeFromDay">GET</a></li></ul></li><li><a href="#">/api/passes/me/by/:idCol/from/:fromDay/to/:toDay</a><ul class='methods'><li data-type='method'><a href="module-passRESTApi.html#~getPassForMeFromToDay">GET</a></li></ul></li><li><a href="#">/api/passes/status/:passId/isMigrating/:state</a><ul class='methods'><li data-type='method'><a href="module-passRESTApi.html#~updateMigrationStatus">PATCH</a></li></ul></li><li><a href="#">/api/passes/status/:passId/state/:state</a><ul class='methods'><li data-type='method'><a href="module-passRESTApi.html#~updatePassState">PATCH</a></li></ul></li><li><a href="#">/api/security/key/:type</a><ul class='methods'><li data-type='method'><a href="module-securityRESTAPI.html#~getPermissionKeyData">GET</a></li></ul></li><li><a href="#">/api/security/key/API/</a><ul class='methods'><li data-type='method'><a href="module-securityRESTAPI.html#~handleNewApiKey">POST</a></li></ul></li><li><a href="#">/api/security/key/NEW_ACCOUNT/</a><ul class='methods'><li data-type='method'><a href="module-securityRESTAPI.html#~handleCreatePermissionKey">POST</a></li></ul></li><li><a href="#">/api/server/config/passGroup/</a><ul class='methods'><li data-type='method'><a href="module-apiRoute.html#~handleGetAccountsByName">GET</a></li></ul></li><li><a href="#">/api/server/config/schedule/</a><ul class='methods'><li data-type='method'><a href="module-apiRoute.html#~getScheduleConstants">GET</a></li></ul></li><li><a href="#">/api/server/config/userGroups/</a><ul class='methods'><li data-type='method'><a href="module-apiRoute.html#~getUserGroups">GET</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-api_userSchedule.html">api/userSchedule</a><ul class='methods'><li data-type='method'><a href="module-api_userSchedule.html#~getAllSchedules">getAllSchedules</a></li><li data-type='method'><a href="module-api_userSchedule.html#~getSchedulesForStudentDash">getSchedulesForStudentDash</a></li><li data-type='method'><a href="module-api_userSchedule.html#~getSchedulesForTeacherDash">getSchedulesForTeacherDash</a></li><li data-type='method'><a href="module-api_userSchedule.html#~setUserSchedule">setUserSchedule</a></li><li data-type='method'><a href="module-api_userSchedule.html#~updateUserSchedule">updateUserSchedule</a></li><li data-type='method'><a href="module-api_userSchedule.html#~updateUserSchedule">updateUserSchedule</a></li></ul></li><li><a href="module-apiRoute.html">apiRoute</a><ul class='methods'><li data-type='method'><a href="module-apiRoute.html#~getScheduleConstants">getScheduleConstants</a></li><li data-type='method'><a href="module-apiRoute.html#~getUserGroups">getUserGroups</a></li><li data-type='method'><a href="module-apiRoute.html#~handleAuthLogin">handleAuthLogin</a></li><li data-type='method'><a href="module-apiRoute.html#~handleGetAccountsByName">handleGetAccountsByName</a></li></ul></li><li><a href="module-authRESTAPI.html">authRESTAPI</a><ul class='methods'><li data-type='method'><a href="module-authRESTAPI.html#~handleAuthLogin">handleAuthLogin</a></li><li data-type='method'><a href="module-authRESTAPI.html#~loginDSCM">loginDSCM</a></li></ul></li><li><a href="module-blackoutAPI.html">blackoutAPI</a></li><li><a href="module-blackoutRESTAPI.html">blackoutRESTAPI</a><ul class='methods'><li data-type='method'><a href="module-blackoutRESTAPI.html#~getBlackoutByDate">getBlackoutByDate</a></li><li data-type='method'><a href="module-blackoutRESTAPI.html#~getBlackoutByUserId">getBlackoutByUserId</a></li><li data-type='method'><a href="module-blackoutRESTAPI.html#~getBlackoutByUserIdAndDate">getBlackoutByUserIdAndDate</a></li><li data-type='method'><a href="module-blackoutRESTAPI.html#~newBlackout">newBlackout</a></li></ul></li><li><a href="module-js_accounts.html">js/accounts</a><ul class='methods'><li data-type='method'><a href="module-js_accounts.html#.get">get</a></li><li data-type='method'><a href="module-js_accounts.html#.newUserSchedule">newUserSchedule</a></li><li data-type='method'><a href="module-js_accounts.html#.replaceUserSchedule">replaceUserSchedule</a></li><li data-type='method'><a href="module-js_accounts.html#.updateUserSchedule">updateUserSchedule</a></li><li data-type='method'><a href="module-js_accounts.html#~changePassword">changePassword</a></li><li data-type='method'><a href="module-js_accounts.html#~createAccount">createAccount</a></li><li data-type='method'><a href="module-js_accounts.html#~getAccountByEmail">getAccountByEmail</a></li><li data-type='method'><a href="module-js_accounts.html#~getSpecificPeriods">getSpecificPeriods</a></li><li data-type='method'><a href="module-js_accounts.html#~getStudentSchedule">getStudentSchedule</a></li><li data-type='method'><a href="module-js_accounts.html#~getTeacherSchedule">getTeacherSchedule</a></li><li data-type='method'><a href="module-js_accounts.html#~getUserByID">getUserByID</a></li><li data-type='method'><a href="module-js_accounts.html#~getUserGroupAccountByName">getUserGroupAccountByName</a></li><li data-type='method'><a href="module-js_accounts.html#~getUserGroupAccountByUserGroup">getUserGroupAccountByUserGroup</a></li><li data-type='method'><a href="module-js_accounts.html#~setVerification">setVerification</a></li><li data-type='method'><a href="module-js_accounts.html#~updateAccountGroupFieldsByID">updateAccountGroupFieldsByID</a></li><li data-type='method'><a href="module-js_accounts.html#~updatePassword">updatePassword</a></li><li data-type='method'><a href="module-js_accounts.html#~updateTags">updateTags</a></li><li data-type='method'><a href="module-js_accounts.html#~verifyPassword">verifyPassword</a></li></ul></li><li><a href="module-js_email.html">js/email</a><ul class='methods'><li data-type='method'><a href="module-js_email.html#~sendActivationEmail">sendActivationEmail</a></li><li data-type='method'><a href="module-js_email.html#~sendMail">sendMail</a></li><li data-type='method'><a href="module-js_email.html#~sendResetPasswordEmail">sendResetPasswordEmail</a></li></ul></li><li><a href="module-js_emailTemplates.html">js/emailTemplates</a></li><li><a href="module-js_import.html">js/import</a><ul class='methods'><li data-type='method'><a href="module-js_import.html#~deleteBulkLog">deleteBulkLog</a></li><li data-type='method'><a href="module-js_import.html#~importAccountsExcel">importAccountsExcel</a></li><li data-type='method'><a href="module-js_import.html#~mapAccounts">mapAccounts</a></li><li data-type='method'><a href="module-js_import.html#~newBulkLog">newBulkLog</a></li><li data-type='method'><a href="module-js_import.html#~updateBulkLog">updateBulkLog</a></li></ul></li><li><a href="module-js_passes.html">js/passes</a><ul class='methods'><li data-type='method'><a href="module-js_passes.html#.flexableGetPasses">flexableGetPasses</a></li><li data-type='method'><a href="module-js_passes.html#.getPass">getPass</a></li><li data-type='method'><a href="module-js_passes.html#.limitTally">limitTally</a></li><li data-type='method'><a href="module-js_passes.html#.newPass">newPass</a></li><li data-type='method'><a href="module-js_passes.html#.updatePass">updatePass</a></li></ul></li><li><a href="module-js_schedules.html">js/schedules</a><ul class='methods'><li data-type='method'><a href="module-js_schedules.html#~getActivePeriodsAtDateTime">getActivePeriodsAtDateTime</a></li></ul></li><li><a href="module-js_security.html">js/security</a><ul class='methods'><li data-type='method'><a href="module-js_security.html#.checkPermissionKey">checkPermissionKey</a></li><li data-type='method'><a href="module-js_security.html#.checkPermissionKeyValidity">checkPermissionKeyValidity</a></li><li data-type='method'><a href="module-js_security.html#.cleanDB">cleanDB</a></li><li data-type='method'><a href="module-js_security.html#.createPermissionKey">createPermissionKey</a></li><li data-type='method'><a href="module-js_security.html#.getPermissionKeyData">getPermissionKeyData</a></li><li data-type='method'><a href="module-js_security.html#.keyUsed">keyUsed</a></li><li data-type='method'><a href="module-js_security.html#.newKey.activateAccount">newKey.activateAccount</a></li><li data-type='method'><a href="module-js_security.html#.newKey.newAccount">newKey.newAccount</a></li><li data-type='method'><a href="module-js_security.html#.newKey.resetPassword">newKey.resetPassword</a></li></ul></li><li><a href="module-js_userSchedule.html">js/userSchedule</a><ul class='methods'><li data-type='method'><a href="module-js_userSchedule.html#.get">get</a></li><li data-type='method'><a href="module-js_userSchedule.html#.getStudentSchedule">getStudentSchedule</a></li><li data-type='method'><a href="module-js_userSchedule.html#.getTeacherSchedule">getTeacherSchedule</a></li><li data-type='method'><a href="module-js_userSchedule.html#.new">new</a></li><li data-type='method'><a href="module-js_userSchedule.html#.replace">replace</a></li><li data-type='method'><a href="module-js_userSchedule.html#.update">update</a></li></ul></li><li><a href="module-js_utils.html">js/utils</a><ul class='methods'><li data-type='method'><a href="module-js_utils.html#.checkPermission">checkPermission</a></li><li data-type='method'><a href="module-js_utils.html#.compileDashboardNav">compileDashboardNav</a></li><li data-type='method'><a href="module-js_utils.html#.getAllowedDashboards">getAllowedDashboards</a></li><li data-type='method'><a href="module-js_utils.html#.middlewarePermission">middlewarePermission</a></li><li data-type='method'><a href="module-js_utils.html#~checkPasswordPolicy">checkPasswordPolicy</a></li><li data-type='method'><a href="module-js_utils.html#~checkPeriod">checkPeriod</a></li><li data-type='method'><a href="module-js_utils.html#~cleanUser">cleanUser</a></li><li data-type='method'><a href="module-js_utils.html#~dscm">dscm</a></li><li data-type='method'><a href="module-js_utils.html#~generateSecureKey">generateSecureKey</a></li><li data-type='method'><a href="module-js_utils.html#~getBrowserSupport">getBrowserSupport</a></li></ul></li><li><a href="module-js_utils_rateLimit.html">js/utils/rateLimit</a><ul class='methods'><li data-type='method'><a href="module-js_utils_rateLimit.html#~emailPasswordResetBruteforce">emailPasswordResetBruteforce</a></li><li data-type='method'><a href="module-js_utils_rateLimit.html#~emailPasswordResetBruteforce">emailPasswordResetBruteforce</a></li><li data-type='method'><a href="module-js_utils_rateLimit.html#~emailPasswordResetBruteforce">emailPasswordResetBruteforce</a></li><li data-type='method'><a href="module-js_utils_rateLimit.html#~loginBruteforce">loginBruteforce</a></li><li data-type='method'><a href="module-js_utils_rateLimit.html#~loginBruteforce">loginBruteforce</a></li></ul></li><li><a href="module-mediaRESTAPI.html">mediaRESTAPI</a><ul class='methods'><li data-type='method'><a href="module-mediaRESTAPI.html#~generateBackdrop">generateBackdrop</a></li><li data-type='method'><a href="module-mediaRESTAPI.html#~getIdenticon">getIdenticon</a></li></ul></li><li><a href="module-miscRESTApi.html">miscRESTApi</a></li><li><a href="module-passportApi.html">passportApi</a><ul class='methods'><li data-type='method'><a href="module-passportApi.html#~getPassGroups">getPassGroups</a></li><li data-type='method'><a href="module-passportApi.html#~getScheduleDefinition">getScheduleDefinition</a></li><li data-type='method'><a href="module-passportApi.html#~getScheduleOfADate">getScheduleOfADate</a></li><li data-type='method'><a href="module-passportApi.html#~newScheduleDefinition">newScheduleDefinition</a></li><li data-type='method'><a href="module-passportApi.html#~scheduleRepeatingScheduleDefinition">scheduleRepeatingScheduleDefinition</a></li><li data-type='method'><a href="module-passportApi.html#~scheduleSingleScheduleDefinition">scheduleSingleScheduleDefinition</a></li></ul></li><li><a href="module-passportAuthApi.html">passportAuthApi</a><ul class='methods'><li data-type='method'><a href="module-passportAuthApi.html#~newJWT">newJWT</a></li><li data-type='method'><a href="module-passportAuthApi.html#~newJWTForCookies">newJWTForCookies</a></li></ul></li><li><a href="module-passRESTApi.html">passRESTApi</a><ul class='methods'><li data-type='method'><a href="module-passRESTApi.html#~getPassForMeFromDay">getPassForMeFromDay</a></li><li data-type='method'><a href="module-passRESTApi.html#~getPassForMeFromToDay">getPassForMeFromToDay</a></li><li data-type='method'><a href="module-passRESTApi.html#~newPassForMe">newPassForMe</a></li><li data-type='method'><a href="module-passRESTApi.html#~updateArrivedStatus">updateArrivedStatus</a></li><li data-type='method'><a href="module-passRESTApi.html#~updateMigrationStatus">updateMigrationStatus</a></li><li data-type='method'><a href="module-passRESTApi.html#~updatePassState">updatePassState</a></li></ul></li><li><a href="module-securityRESTAPI.html">securityRESTAPI</a><ul class='methods'><li data-type='method'><a href="module-securityRESTAPI.html#~getPermissionKeyData">getPermissionKeyData</a></li><li data-type='method'><a href="module-securityRESTAPI.html#~handleCreatePermissionKey">handleCreatePermissionKey</a></li><li data-type='method'><a href="module-securityRESTAPI.html#~handleNewApiKey">handleNewApiKey</a></li></ul></li><li><a href="module-webpack_api_accounts.html">webpack/api/accounts</a><ul class='methods'><li data-type='method'><a href="module-webpack_api_accounts.html#.get">get</a></li><li data-type='method'><a href="module-webpack_api_accounts.html#.getWithClasses">getWithClasses</a></li></ul></li><li><a href="module-webpack_api_import.html">webpack/api/import</a><ul class='methods'><li data-type='method'><a href="module-webpack_api_import.html#.searchBulkLogs">searchBulkLogs</a></li></ul></li><li><a href="module-webpack_api_misc.html">webpack/api/misc</a><ul class='methods'><li data-type='method'><a href="module-webpack_api_misc.html#.getScheduleConfig">getScheduleConfig</a></li><li data-type='method'><a href="module-webpack_api_misc.html#.getUserGroups">getUserGroups</a></li></ul></li><li><a href="module-webpack_api_schedule.html">webpack/api/schedule</a><ul class='methods'><li data-type='method'><a href="module-webpack_api_schedule.html#.getSchedules">getSchedules</a></li><li data-type='method'><a href="module-webpack_api_schedule.html#.newSchedule">newSchedule</a></li><li data-type='method'><a href="module-webpack_api_schedule.html#.replaceSchedule">replaceSchedule</a></li><li data-type='method'><a href="module-webpack_api_schedule.html#.updateSchedule">updateSchedule</a></li></ul></li><li><a href="module-webpack_api_security.html">webpack/api/security</a><ul class='methods'><li data-type='method'><a href="module-webpack_api_security.html#.newAccount">newAccount</a></li></ul></li><li><a href="module-webpack_buttonLoader.html">webpack/buttonLoader</a><ul class='methods'><li data-type='method'><a href="module-webpack_buttonLoader.html#.done">done</a></li><li data-type='method'><a href="module-webpack_buttonLoader.html#.fail">fail</a></li><li data-type='method'><a href="module-webpack_buttonLoader.html#.load">load</a></li><li data-type='method'><a href="module-webpack_buttonLoader.html#.success">success</a></li><li data-type='method'><a href="module-webpack_buttonLoader.html#.warning">warning</a></li></ul></li><li><a href="module-webpack_unsavedWork.html">webpack/unsavedWork</a><ul class='methods'><li data-type='method'><a href="module-webpack_unsavedWork.html#.button">button</a></li><li data-type='method'><a href="module-webpack_unsavedWork.html#.changed">changed</a></li><li data-type='method'><a href="module-webpack_unsavedWork.html#.destroy">destroy</a></li><li data-type='method'><a href="module-webpack_unsavedWork.html#.reset">reset</a></li><li data-type='method'><a href="module-webpack_unsavedWork.html#.saved">saved</a></li></ul></li><li><a href="module-webpack_utils.html">webpack/utils</a><ul class='methods'><li data-type='method'><a href="module-webpack_utils.html#.closePage">closePage</a></li><li data-type='method'><a href="module-webpack_utils.html#.distinctKeys">distinctKeys</a></li><li data-type='method'><a href="module-webpack_utils.html#.fetch">fetch</a></li><li data-type='method'><a href="module-webpack_utils.html#.fetchJSON">fetchJSON</a></li><li data-type='method'><a href="module-webpack_utils.html#.fetchStatus">fetchStatus</a></li><li data-type='method'><a href="module-webpack_utils.html#.getCookie">getCookie</a></li><li data-type='method'><a href="module-webpack_utils.html#.loader">loader</a></li><li data-type='method'><a href="module-webpack_utils.html#.materialResponse">materialResponse</a></li><li data-type='method'><a href="module-webpack_utils.html#.openPage">openPage</a></li><li data-type='method'><a href="module-webpack_utils.html#.setCookie">setCookie</a></li><li data-type='method'><a href="module-webpack_utils.html#.thisUser">thisUser</a></li><li data-type='method'><a href="module-webpack_utils.html#.throwError">throwError</a></li><li data-type='method'><a href="module-webpack_utils.html#.urlQuery">urlQuery</a></li><li data-type='method'><a href="module-webpack_utils.html#.uuidv4">uuidv4</a></li></ul></li></ul><h3>Classes</h3><ul><li><a href="Caret.html">Caret</a></li><li><a href="StudentScheduleEditor.html">StudentScheduleEditor</a><ul class='methods'><li data-type='method'><a href="StudentScheduleEditor.html#checkValidity">checkValidity</a></li><li data-type='method'><a href="StudentScheduleEditor.html#generate">generate</a></li><li data-type='method'><a href="StudentScheduleEditor.html#getHasChanged">getHasChanged</a></li><li data-type='method'><a href="StudentScheduleEditor.html#submit">submit</a></li></ul></li><li><a href="Table.html">Table</a></li><li><a href="TeacherScheduleEditor.html">TeacherScheduleEditor</a><ul class='methods'><li data-type='method'><a href="TeacherScheduleEditor.html#checkValidity">checkValidity</a></li><li data-type='method'><a href="TeacherScheduleEditor.html#generate">generate</a></li><li data-type='method'><a href="TeacherScheduleEditor.html#getHasChanged">getHasChanged</a></li><li data-type='method'><a href="TeacherScheduleEditor.html#submit">submit</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">modules/webpack/entrypoints/accounts/profile.js</h1>
    

    <!--container.tmpl-->




    <!--source.tmpl-->

    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*

Passport-Live is a modern web app for schools that helps them manage passes.
    Copyright (C) 2017  Joseph Hassell

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published
    by the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see &lt;http://www.gnu.org/licenses/>.

email: hi@josephhassell.com

*/
var Caret = require("../../common/Caret.js");
var StudentScheduleEditor = require("../../sections/StudentScheduleEditor.js");
var TeacherScheduleEditor = require("../../sections/TeacherScheduleEditor.js");
var utils = require("../../utils/index.js");
var scheduleJS = require("../../api/schedule.js");
var unsavedWork = require("../../common/unsavedWork.js")
var anime = require("animejs");
var Table = require("../../common/Table.js")

var studentScheduleEditor = null;
var teacherScheduleEditor = null;
var studentTable = null;
var teacherTable = null;
window.onload = function() {
    routeHash();
    console.log(utils.thisUser())
    $('.tooltipped').tooltip({delay: 50});
    $(".button-collapse").sideNav();
    $(window).stellar({
        responsive: true,
    });
    loadMyStudentSchedule();
    loadMyTeacherSchedule();
    //check for changes on settings card
    $("#settingsCard").find("input").on("change", settingNeedsSaving);

    
    //Advanced Options for schedule editor 
    var ADVschedule = new Caret($("#se-advancedOptionsCaret"), $("#se-advancedOptionsDIV"));
    ADVschedule.initialize();

}



//Router
window.addEventListener("hashchange", routeHash);
function routeHash() {
    let hash = window.location.hash;
    console.log(hash)
    switch(hash) {
        case "#editSchedule": 
            utils.openPage("scheduleEditor");
            $(".mixenSESave").removeClass("disabled");
            initScheduleEditor();
            break;
        default: 
            $(".mixenSESave").addClass("disabled");
            utils.closePage("scheduleEditor");
    }
}


/** SCHEDULE EDITOR **/ 
function initScheduleEditor() {
    //init the back button
    unsavedWork.button("#mixenSEBack", {
        onAction: () => {
            console.log("action")
        },
        onDiscard: () => {
            unsavedWork.reset("#mixenSEBack");
            studentScheduleEditor.clearContainer();
            teacherScheduleEditor.clearContainer();
            console.log("discard")
        },
        onWarn: (event) => {
            event.element.find("i").html("backspace");
            Materialize.toast($("&lt;span>You have unsaved work&lt;/span>").append($("&lt;br/>")).append("&lt;span>Click back again to discard&lt;/span>"), 10000)
            console.log("Warning")
        },
        onSave: (element) => {
            console.log("Saved")
        },
        onReset: (element) => {
            element.find("i").html("arrow_back");
            console.log("Reset")
        }
    })
    //init the various schedules
    
    if($("#editStudentScheduleContainer").length > 0) {
        initStudentScheduleEditor();
    }
    if($("#editTeacherScheduleContainer").length > 0) {
        initTeacherScheduleEditor();
    }
    

}




/* Student Editor */
function initStudentScheduleEditor() {
    if($("#editStudentScheduleContainer").children().length &lt;=0) {
        console.log("RUNN")
        studentScheduleEditor = new StudentScheduleEditor($("#editStudentScheduleContainer"), {
            onChange: (e) => {
                console.log("changed")
                unsavedWork.changed("#mixenSEBack");
            }
        });
        genStudentScheduleEditor();
        /* Schedule Editor Options */
        $("#se-advancedOptions-studentRecovery").off("click");
        $("#se-advancedOptions-studentRecovery").on("change", (e) => {
            if($(e.currentTarget).prop('checked')) {
                genStudentScheduleEditor(true);
            } else {
                genStudentScheduleEditor();
            }
            
        })
    }
}



function genStudentScheduleEditor(startClean) {
    studentScheduleEditor.generate(startClean).then(() => {
        console.log("Generated Student")
        scheduleEditorOnSave();
    }).catch(err => utils.throwError(err))
}

function initTeacherScheduleEditor() {
    if($("#editTeacherScheduleContainer").children().length &lt;=0) {
        /* Schedule Editor Options */
        teacherScheduleEditor = new TeacherScheduleEditor($("#editTeacherScheduleContainer"), {
            onChange: (e) => {
                console.log("changed")
                unsavedWork.changed("#mixenSEBack");
            }
        });
        genTeacherScheduleEditor();
        $("#se-advancedOptions-teacherRecovery").off("click");
        $("#se-advancedOptions-teacherRecovery").on("change", (e) => {
            if($(e.currentTarget).prop('checked')) {
                genTeacherScheduleEditor(true);
            } else {
                genTeacherScheduleEditor();
            }
            
        })
    }
}

function genTeacherScheduleEditor(startClean) {
    teacherScheduleEditor.generate(startClean).then(() => {
        console.log("Generated Teacher")
        scheduleEditorOnSave();
    }).catch(err => utils.throwError(err))

}




function scheduleEditorOnSave() {
    $("a.mixenSESave").off("click");
    $("a.mixenSESave").on("click", (e) => {
        $("a.mixenSESave").addClass("disabled");
        let prom = [];
        if(studentScheduleEditor &amp;&amp; studentScheduleEditor.getHasChanged()) {
            prom.push(studentScheduleEditor.submit())
        } else {
            prom.push(new Promise((resolve) => {return resolve();}))
        }
        if(teacherScheduleEditor &amp;&amp; teacherScheduleEditor.getHasChanged()) {
            prom.push(teacherScheduleEditor.submit());
        } else {prom.push(new Promise((resolve) => {return resolve();}))}

        Promise.all(prom).then(([student, teacher]) => {
            console.log("Student Response", student);
            console.log("Teacher Response", teacher);
            scheduleEditorSubmitRes(student, teacher);
        }).catch((err) => {$("a.mixenSESave").removeClass("disabled"); utils.throwError(err)})
    })
}


function scheduleEditorSubmitRes(student, teacher) {
    if(student) {
        if(student.transaction &amp;&amp; student.transaction.unchanged >= 1) {
            Materialize.toast('Student schedule unchanged', 4000)
        } else {
            Materialize.toast('Updated student schedule', 4000)
            loadMyStudentSchedule();
            
        }
    }

    if(teacher) {
        if(teacher.transaction &amp;&amp; teacher.transaction.unchanged >= 1) {
            Materialize.toast('Teacher schedule unchanged', 4000)
        } else {
            Materialize.toast('Updated teacher schedule', 4000)
            loadMyTeacherSchedule();
            
        }
    }

    if(student || teacher) {
        unsavedWork.saved("#mixenSEBack");
        window.location.hash = "";
        if((student &amp;&amp; student.transaction &amp;&amp; student.transaction.unchanged &lt; 1) &amp;&amp; (teacher &amp;&amp; teacher.transaction &amp;&amp; teacher.transaction.unchanged &lt; 1)) {
            utils.materialResponse("check", "success")
        } else if((student &amp;&amp; student.transaction &amp;&amp; student.transaction.unchanged &lt; 1) &amp;&amp; !teacher) {
            utils.materialResponse("check", "success")
        } else if((teacher &amp;&amp; teacher.transaction &amp;&amp; teacher.transaction.unchanged &lt; 1) &amp;&amp; !student) {
            utils.materialResponse("check", "success")
        }
    }
}

var idOfUser = utils.thisUser();




function loadMyStudentSchedule() {
    if($("#studentSchedule").length > 0) {
        scheduleJS.getSchedules(utils.thisUser()).then((data) => {
            console.log(data)
            data = data.studentType;
            if(data &amp;&amp; data.schedule) {
                //clear area
                $("#studentScheduleBody").empty();
                //do stuff with schedule 
                //console.log(data)
                var keys = Object.keys(data.schedule);
                let schedule = data.schedule;
                let tableData = Object.keys(schedule);
                tableData = tableData.map(function(period) {
                    //console.log(schedule[period])
                    return {
                        Period: period.charAt(0).toUpperCase() + period.slice(1),
                        Class: schedule[period].teacher &amp;&amp; schedule[period].teacher.period &amp;&amp; schedule[period].teacher.period.className ? schedule[period].teacher.period.className : "",
                        Teacher: schedule[period].teacher ? schedule[period].teacher.name.first + " " + schedule[period].teacher.name.last : "",
                        Teaching: schedule[period].teacher &amp;&amp; schedule[period].teacher.period &amp;&amp; schedule[period].teacher.period.isTeaching ? "&lt;i class=\"material-icons\">check_circle&lt;/i>" : "&lt;i class=\"material-icons\">cancel&lt;/i>",
                        Room: schedule[period].teacher &amp;&amp; schedule[period].teacher.period &amp;&amp; schedule[period].teacher.period.room ? schedule[period].teacher.period.room : "",
                        Limit: schedule[period].teacher &amp;&amp; schedule[period].teacher.period &amp;&amp; typeof schedule[period].teacher.period.passLimit === "number" ? schedule[period].teacher.period.passLimit : "∞",
                    }
                })
                
                if(studentTable) {
                    studentTable.replaceData(tableData);
                    studentTable.emptyContainer();
                    studentTable.generate().catch((err) => {utils.throwError(err)})
                } else {
                    studentTable = new Table("#studentSchedule", tableData, {
                        tableClasses: "highlight responsive-table"
                    })
                    studentTable.generate().catch((err) => {utils.throwError(err)})
                }
                /*for(var i = 0; i &lt; keys.length; i++) {
                  //set defaults 
                  if(data.schedule[keys[i]]) {
                    var tr = document.createElement("TR");
                    //create elements
                    var idEl = document.createElement("TD");
                    var idElText = document.createTextNode(keys[i].charAt(0).toUpperCase() + keys[i].slice(1));

                    var classEl = document.createElement("TD");
                    if(data.schedule[keys[i]] &amp;&amp; data.schedule[keys[i]].teacher &amp;&amp; data.schedule[keys[i]].teacher.period &amp;&amp; data.schedule[keys[i]].teacher.period.className) {
                      var classElText = document.createTextNode(data.schedule[keys[i]].teacher.period.className);
                    } else {
                      var classElText = document.createTextNode(" ");
                    }

                    var teacherEl = document.createElement("TD");
                    
                    if(data.schedule[keys[i]] &amp;&amp; data.schedule[keys[i]].teacher) {
                      var teacherElText = document.createTextNode(data.schedule[keys[i]].teacher.name.first + " " +  data.schedule[keys[i]].teacher.name.last);
                    } else {
                      var teacherElText = document.createTextNode(" ");
                      
                    }
                    var roomEl = document.createElement("TD");
                    if(data.schedule[keys[i]] &amp;&amp; data.schedule[keys[i]].teacher &amp;&amp; data.schedule[keys[i]].teacher.period &amp;&amp; data.schedule[keys[i]].teacher.period.room) {
                      var roomElText = document.createTextNode(data.schedule[keys[i]].teacher.period.room);
                    } else {
                      var roomElText = document.createTextNode(" ");
                    }

                    //append
                    idEl.appendChild(idElText);
                    tr.appendChild(idEl);

                    classEl.appendChild(classElText);
                    tr.appendChild(classEl);

                    teacherEl.appendChild(teacherElText);
                    tr.appendChild(teacherEl);

                    roomEl.appendChild(roomElText);
                    tr.appendChild(roomEl);

                    //set
                    $('#studentScheduleBody').append(tr);
                  }
                }*/

            } else {
                var err = new Error("Please click on the edit (pencil) button and add a student schedule.");
                markScheduleEditButton(1);
                return utils.throwError(err);
            }
        }).catch((err) => {
            return utils.throwError(err);
        })
    }
}

function loadMyTeacherSchedule() {
    if($("#teacherSchedule").length > 0) {
        scheduleJS.getSchedules().then((data) => {
            data = data.teacherType;
            if(data &amp;&amp; data.schedule) {
                let schedule = data.schedule;
                let tableData = Object.keys(schedule);
                tableData = tableData.map(function(period) {
                    //console.log(schedule[period])
                    return {
                        Period: period.charAt(0).toUpperCase() + period.slice(1),
                        Class: (schedule[period].className || ""),
                        Teaching: schedule[period].isTeaching ? "&lt;i class=\"material-icons\">check_circle&lt;/i>" : "&lt;i class=\"material-icons\">cancel&lt;/i>",
                        Room: (schedule[period].room || ""),
                        Limit: typeof schedule[period].passLimit === "number" ? schedule[period].passLimit : "∞",
                    }
                })
                //console.log(tableData)
                if(teacherTable) {
                    teacherTable.replaceData(tableData);
                    teacherTable.emptyContainer();
                    teacherTable.generate().catch((err) => {utils.throwError(err)})
                } else {
                    teacherTable = new Table("#teacherSchedule", tableData, {
                        tableClasses: "highlight responsive-table"
                    })
                    teacherTable.generate().catch((err) => {utils.throwError(err)})
                }
            } else {
                var err = new Error("Please click on the edit (pencil) button and add a teacher schedule.");
                markScheduleEditButton(1);
                return utils.throwError(err);
            }
        }).catch((err) => {
            return utils.throwError(err);
        })
    }
}

function markScheduleEditButton(loop) {
    
    $("#openScheduleEditor").removeClass("black-text").css("transition", "all 0s")
    anime({
        targets: '#openScheduleEditor',
        rotateZ: {
            value: "+=720",
            duration: 1200,
        },
        color: [
            {value: "rgb(0,255,0)", duration: 300},
            {value: "rgb(255,0,0)", duration: 400},
            {value: "rgb(0,0,255)", duration: 500},
            {value: "rgb(0,0,0)", duration: 100}
        ],
        scale: [                
            {value: 3, duration: 500},
            {value: 3, duration: 200},
            {value: 1, duration: 500}
        ],
        easing: [.91,-0.54,.29,1.56],
        elasticity: 400,
        loop: loop
    });
}

function settingNeedsSaving(e) {
    $("#saveSettings").removeClass("disabled").addClass("pulse").attr("onclick");
    $("#saveSettings").on("click", saveSettings);
}
function saveSettings(e) {
    console.log("Not Implemented")
}


// (I'm a nerd :P)
//call key press function 
document.onkeydown = checkKey;
var konami = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];
var konamiUser = 0;
function checkKey(e) {
    e = e || window.event;
    if(konami[konamiUser] != e.keyCode) {
        konamiUser = 0;
    } else {
        konamiUser++;
    }
    if (konami.length == konamiUser) {
        konamiUser = 0;
        spinneyMcSpinFace();
        /*Materialize.toast('THIS IS AN EASTER EGG!', 6000)
        setTimeout(function() {
            Materialize.toast('I need ideas!', 6000)
        }, 1000);
        console.log("TODO EASTER EGG")*/
    }
    
}

function spinneyMcSpinFace() {
    markScheduleEditButton(5);
    anime({
        targets: 'img#avatar',
        rotateZ: {
            value: "+=720",
            duration: 5000,
        },
        backgroundColor: [
            {value: "rgb(0,255,0)", duration: 1000},
            {value: "rgb(255,0,0)", duration: 1500},
            {value: "rgb(0,0,255)", duration: 1500},
            {value: "#e0e0e0", duration: 1000}
        ],
        translateY: [
            {value: "100%", duration: 1500},
            {value: "100%", duration: 4000},
            {value: "0%", duration: 1500}
        ],
        scale: [                
            {value: 10, duration: 3000},
            {value: 10, duration: 1000},
            {value: 1, duration: 500}
        ],
        easing: [.91,-0.54,.29,1.56],
        elasticity: 400,
        loop: 1
    });
    anime({
        targets: 'img#user-bg',
        translateY: [
            {value: "+=100", duration: 4500},
            {value: "-=100", duration: 500}
        ],
        easing: [.91,-0.54,.29,1.56],
        elasticity: 400,
        loop: 1
    })
}



</code></pre>
        </article>
    </section>





</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Jan 15 2018 17:13:12 GMT+0000 (UTC) using the LOKE theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
